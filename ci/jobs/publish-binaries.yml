tags: [publish]
serial: true
plan:
- aggregate:
  - get: version
    passed: [shipit]
    trigger: true
  - get: concourse
    passed: [shipit]
  - get: unit-image
    passed: [shipit]
  - get: linux-rc
    passed: [shipit]
  - get: windows-rc
    passed: [shipit]
  - get: darwin-rc
    passed: [shipit]
- task: prep-release-assets
  file: concourse/ci/tasks/prep-release-assets.yml
  image: unit-image
- task: build-release-notes
  file: concourse/ci/tasks/build-release-notes.yml
  image: unit-image
- put: concourse-github-release
  params:
    commitish: concourse/.git/ref
    tag: version/version
    tag_prefix: v
    name: release-notes/release-name
    body: release-notes/notes.md
    globs:
    - concourse-linux/*.tgz
    - concourse-windows/*.zip
    - concourse-darwin/*.tgz
    - fly-linux/fly-linux-*.tgz
    - fly-windows/fly-windows-*.zip
    - fly-darwin/fly-darwin-*.tgz
